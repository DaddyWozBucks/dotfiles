#!/bin/sh

set -e

echo '--> Fetch latest dotfiles'
for dir in "${DOTFILES_ROOT}"/*;
do
	(cd "${dir}"; git pull --quiet)
done

echo '--> Update latest dotfiles'
rcup

echo '--> Keep Homebrew up-to-date'
brew upgrade
brew cask upgrade
brew cleanup

echo "--> Updating Brews"
shopt -s nullglob
for brewfile in "${DOTFILES}"/{itsmycargo,local}/Brewfile;
do
  [ -e "${brewfile}" ] && $(command -v brew) bundle install --file="${brewfile}"
done
shopt -u nullglob
